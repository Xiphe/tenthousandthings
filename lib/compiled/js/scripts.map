{"version":3,"file":"scripts.js","sources":["../../src/js/init.js","../../src/js/directive.crazyness-slider.js","../../src/js/directive.list.js","../../src/js/directive.thing-content.js","../../src/js/directive.thing.js","../../src/js/service.color.js","../../../.tmp/ngtemplates.js"],"names":["angular","module","directive","colorService","restrict","replace","scope","templateUrl","link","salts","getSalts","originalSalts","copy","crazylevel","$watch","oldLevelOfCrazyness","newLevelOfCrazyness","forEach","salt","key","PAGE_URL","$http","$q","controller","$scope","hasPages","pages","page","loadPage","i","d","defer","pageUrl","get","then","result","resolve","data","reject","promise","applyPageContents","contents","things","thing","loaded","isUndefined","path","content","ttt","window","setSalt","colorSalt","colorSalt2","initial","scroll","when","$compile","element","compile","append","$sce","postDate","Date","date","isoDate","toISOString","getDate","getMonth","getFullYear","getHours","getMinutes","getStyle","background","stringToColor","categories","border","isLight","background-color","border-color","factory","hashCode","str","hash","length","charCodeAt","intToRGB","color","shift","hex","toString","k","colors","r","parseInt","substring","g","b","o","Math","round","default","run","$templateCache","put"],"mappings":"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","sourcesContent":["/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings', ['infinite-scroll']);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings').directive('tttCrazynessSlider', [\n    'tttColor',\n    function(colorService) {\n      return {\n        restrict: 'E',\n        replace: true,\n        scope: true,\n        templateUrl: 'crazyness-slider.html',\n        link: function(scope) {\n          var salts = colorService.getSalts();\n          var originalSalts = angular.copy(salts);\n\n          scope.crazylevel = 0;\n\n          scope.$watch('crazylevel', function(oldLevelOfCrazyness, newLevelOfCrazyness) {\n            if (oldLevelOfCrazyness === newLevelOfCrazyness) {\n              return;\n            }\n            angular.forEach(salts, function(salt, key) {\n              salts[key] = originalSalts[key] + newLevelOfCrazyness;\n            });\n          });\n        }\n      };\n    }\n  ]);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  /** @const */\n  var PAGE_URL = '/_things/page:page.json';\n\n  angular.module('tenthousandthings').directive('tttList', [\n    '$http', '$q', 'tttColor',\n    function($http, $q, colorService) {\n      return {\n        restrict: 'E',\n        replace: true,\n        templateUrl: 'list.html',\n        controller: [\n          '$scope',\n          function($scope) {\n            var ttt = window.ttt;\n            var page = ttt.page || 1;\n            var pages = ttt.pages || 1;\n            delete window.ttt;\n\n            colorService.setSalt(ttt.colorSalt);\n            colorService.setSalt(ttt.colorSalt2, '2');\n\n            function hasPages() {\n              return pages > page;\n            }\n\n            function loadPage(i) {\n              var d = $q.defer();\n              var pageUrl = PAGE_URL.replace(':page', i);\n              $http.get(pageUrl).then(function(result) {\n                d.resolve(result.data);\n              }, d.reject);\n\n              return d.promise;\n            }\n\n            function applyPageContents(contents) {\n              $scope.things.forEach(function(thing) {\n                if (thing.loaded) { return; }\n                if (!angular.isUndefined(contents[thing.path])) {\n                  thing.content = contents[thing.path];\n                  thing.loaded = true;\n                }\n              });\n            }\n\n            $scope.things = ttt.initial || [];\n            $scope.hasPages = hasPages();\n\n            $scope.scroll = function() {\n              if ($scope.hasPages) {\n                $scope.hasPages = false;\n                $q.when(loadPage(page + 1))\n                  .then(applyPageContents)\n                  .then(function() {\n                    page += 1;\n                    $scope.hasPages = hasPages();\n                  });\n              }\n            };\n          }\n        ]\n      };\n    }\n  ]);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings').directive('tttThingContent', [\n    '$compile',\n    function($compile) {\n      return {\n        restrict: 'C',\n        link: function(scope, element) {\n          var content = scope.thing.content;\n\n          if (scope.thing.compile) {\n            content = $compile(content)(scope);\n          }\n\n          element.append(content);\n        }\n      };\n    }\n  ]);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings').directive('tttThing', [\n    'tttColor',\n    function(colorService) {\n      return {\n        restrict: 'E',\n        replace: true,\n        scope: {\n          thing: '='\n        },\n        templateUrl: 'thing.html',\n        controller: [\n          '$sce', '$scope',\n          function($sce, $scope) {\n            var postDate = new Date($scope.thing.date);\n\n            $scope.thing.isoDate = postDate.toISOString();\n            $scope.thing.date = postDate.getDate() + '.' +\n              postDate.getMonth() + '.' + postDate.getFullYear() +\n              ' - ' + postDate.getHours() + ':' + postDate.getMinutes();\n\n            $scope.getStyle = function() {\n              var background = colorService.stringToColor($scope.thing.categories[0]);\n              var border = colorService.stringToColor($scope.thing.categories[0], '2');\n\n              $scope.isLight = colorService.isLight(background);\n\n              return {\n                'background-color': '#' + background,\n                'border-color': '#' + border\n              };\n            };\n          }\n        ]\n      };\n    }\n  ]);\n})();\n","/* global angular */\n/* jshint bitwise: false */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings').factory('tttColor', [\n    function() {\n      var colors = {};\n      var salts = {\n        'default': ''\n      };\n\n      /* http://stackoverflow.com/questions/3426404/create-a-hexadecimal-colour-based-on-a-string-with-javascript */\n      function hashCode(str) { // java String#hashCode\n        var hash = 0;\n        for (var i = 0; i < str.length; i++) {\n          hash = str.charCodeAt(i) + ((hash << 5) - hash);\n          hash |= 1;\n        }\n\n        return hash;\n      }\n\n      function intToRGB(i) {\n        var color = '';\n        [0, 8, 16].forEach(function(shift) {\n          var hex = ((i >> shift) & 0xFF).toString(16);\n          if (hex.length === 1) {\n            hex = 0 + hex;\n          }\n          color += hex;\n        });\n\n        return color;\n      }\n\n      function stringToColor(str, k) {\n        var key = 'default';\n        if (k) {\n          key = '_' + k;\n        }\n\n        str += salts[key];\n\n        if (!colors[str]) {\n          colors[str] = intToRGB(hashCode(str));\n        }\n\n        return colors[str];\n      }\n\n      /* http://stackoverflow.com/questions/11867545/change-text-color-based-on-brightness-of-the-covered-background-area */\n      function isLight(color) {\n        var r = parseInt(color.substring(0, 2), 16);\n        var g = parseInt(color.substring(2, 4), 16);\n        var b = parseInt(color.substring(4, 6), 16);\n        var o = Math.round(((r * 299) + (g * 587) + (b * 114)) / 1000);\n\n        return o > 125;\n      }\n\n      function setSalt(salt, k) {\n        var key = 'default';\n        if (k) {\n          key = '_' + k;\n        }\n        salts[key] = '' + salt;\n      }\n\n      function getSalts() {\n        return salts;\n      }\n\n      return {\n        stringToColor: stringToColor,\n        isLight: isLight,\n        setSalt: setSalt,\n        getSalts: getSalts\n      };\n    }\n  ]);\n})();\n","angular.module('tenthousandthings').run(['$templateCache', function($templateCache) {\n  'use strict';\n\n  $templateCache.put('crazyness-slider.html',\n    \"<input type=\\\"range\\\" ng-model=\\\"crazylevel\\\" min=\\\"0\\\" max=\\\"100000\\\" class=\\\"ttt-crazyness\\\" />\"\n  );\n\n\n  $templateCache.put('list.html',\n    \"<div class=\\\"ttt-list\\\"\\n\" +\n    \"\\tinfinite-scroll=\\\"scroll()\\\"\\n\" +\n    \"\\tinfinite-scroll-disabled=\\\"!hasPages\\\"\\n\" +\n    \"\\tinfinite-scroll-immediate-check=\\\"false\\\"\\n\" +\n    \">\\n\" +\n    \"\\t<ttt-thing ng-repeat=\\\"thing in things\\\" thing=\\\"thing\\\"></ttt-thing>\\n\" +\n    \"</div>\"\n  );\n\n\n  $templateCache.put('thing.html',\n    \"<article\\n\" +\n    \"\\tng-if=\\\"thing.loaded\\\"\\n\" +\n    \"\\tclass=\\\"ttt-thing\\\"\\n\" +\n    \"\\tng-class=\\\"isLight ? 'ttt-light-bg' : 'ttt-dark-bg'\\\"\\n\" +\n    \"\\tng-style=\\\"getStyle()\\\"\\n\" +\n    \">\\n\" +\n    \"\\t<div class=\\\"ttt-thing-i-wrap\\\">\\n\" +\n    \"\\t\\t<div class=\\\"ttt-thing-i\\\">#{{thing.i}}</div>\\n\" +\n    \"\\t</div>\\n\" +\n    \"\\t<div class=\\\"ttt-wrap\\\">\\n\" +\n    \"\\t\\t<header>\\n\" +\n    \"\\t\\t\\t<h3>{{thing.title}}</h3>\\n\" +\n    \"\\t\\t\\t<div class=\\\"ttt-thing-meta\\\">\\n\" +\n    \"\\t\\t\\t\\t<time datetime=\\\"{{thing.isoDate}}\\\">{{thing.date}}</time> in\\n\" +\n    \"\\t\\t\\t\\t<span ng-repeat=\\\"category in thing.categories\\\" class=\\\"ttt-thing-category\\\" rel=\\\"category\\\">\\n\" +\n    \"\\t\\t\\t\\t\\t{{category}}\\n\" +\n    \"\\t\\t\\t\\t</span>\\n\" +\n    \"\\t\\t\\t</div>\\n\" +\n    \"\\t\\t</header>\\n\" +\n    \"\\t\\t<div class=\\\"ttt-thing-content\\\"></div>\\n\" +\n    \"\\t</div>\\n\" +\n    \"</article>\"\n  );\n\n}]);\n"]}