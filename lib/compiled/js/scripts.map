{"version":3,"file":"scripts.js","sources":["../../src/js/init.js","../../src/js/directive.list.js","../../src/js/directive.thing.js","../../../.tmp/ngtemplates.js"],"names":["angular","module","PAGE_URL","directive","$http","$q","restrict","replace","templateUrl","controller","$scope","hasPages","pages","page","loadPage","i","d","defer","pageUrl","get","then","result","resolve","data","reject","promise","applyPageContents","contents","things","forEach","thing","loaded","isUndefined","path","content","ttt","window","initial","scroll","when","scope","$sce","getContent","trustAsHtml","run","$templateCache","put"],"mappings":"CACA,WACE,YAEAA,SAAQC,OAAO,qBAAsB,uBCHvC,WACE,YAGA,IAAIC,GAAW,yBAEfF,SAAQC,OAAO,qBAAqBE,UAAU,WAC5C,QAAS,KACT,SAASC,EAAOC,GACd,OACEC,SAAU,IACVC,SAAS,EACTC,YAAa,YACbC,YACE,SACA,SAASC,GAMP,QAASC,KACP,MAAOC,GAAQC,EAGjB,QAASC,GAASC,GAChB,GAAIC,GAAIX,EAAGY,QACPC,EAAUhB,EAASK,QAAQ,QAASQ,EAKxC,OAJAX,GAAMe,IAAID,GAASE,KAAK,SAASC,GAC/BL,EAAEM,QAAQD,EAAOE,OAChBP,EAAEQ,QAEER,EAAES,QAGX,QAASC,GAAkBC,GACzBjB,EAAOkB,OAAOC,QAAQ,SAASC,GACzBA,EAAMC,QACL/B,QAAQgC,YAAYL,EAASG,EAAMG,SACtCH,EAAMI,QAAUP,EAASG,EAAMG,MAC/BH,EAAMC,QAAS,KAxBrB,GAAII,GAAMC,OAAOD,IACbtB,EAAOsB,EAAItB,MAAQ,EACnBD,EAAQuB,EAAIvB,OAAS,QAClBwB,QAAOD,IA0BdzB,EAAOkB,OAASO,EAAIE,YACpB3B,EAAOC,SAAWA,IAElBD,EAAO4B,OAAS,WACV5B,EAAOC,WACTD,EAAOC,UAAW,EAClBN,EAAGkC,KAAKzB,EAASD,EAAO,IACrBO,KAAKM,GACLN,KAAK,WACJP,GAAQ,EACRH,EAAOC,SAAWA,iBCvDtC,WACE,YAEAX,SAAQC,OAAO,qBAAqBE,UAAU,YAC5C,WACE,OACEG,SAAU,IACVC,SAAS,EACTiC,OACEV,MAAO,KAETtB,YAAa,aACbC,YACE,OAAQ,SACR,SAASgC,EAAM/B,GAEbA,EAAOgC,WAAa,WAClB,MAAIhC,GAAOoB,MAAMC,OACRU,EAAKE,YAAYjC,EAAOoB,MAAMI,SADvC,iBClBdlC,QAAQC,OAAO,qBAAqB2C,KAAK,iBAAkB,SAASC,GAClE,YAEAA,GAAeC,IAAI,YACjB,sNAUFD,EAAeC,IAAI,aACjB","sourcesContent":["/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings', ['infinite-scroll']);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  /** @const */\n  var PAGE_URL = '/_things/page:page.json';\n\n  angular.module('tenthousandthings').directive('tttList', [\n    '$http', '$q',\n    function($http, $q) {\n      return {\n        restrict: 'E',\n        replace: true,\n        templateUrl: 'list.html',\n        controller: [\n          '$scope',\n          function($scope) {\n            var ttt = window.ttt;\n            var page = ttt.page || 1;\n            var pages = ttt.pages || 1;\n            delete window.ttt;\n\n            function hasPages() {\n              return pages > page;\n            }\n\n            function loadPage(i) {\n              var d = $q.defer();\n              var pageUrl = PAGE_URL.replace(':page', i);\n              $http.get(pageUrl).then(function(result) {\n                d.resolve(result.data);\n              }, d.reject);\n\n              return d.promise;\n            }\n\n            function applyPageContents(contents) {\n              $scope.things.forEach(function(thing) {\n                if (thing.loaded) { return; }\n                if (!angular.isUndefined(contents[thing.path])) {\n                  thing.content = contents[thing.path];\n                  thing.loaded = true;\n                }\n              });\n            }\n\n            $scope.things = ttt.initial || [];\n            $scope.hasPages = hasPages();\n\n            $scope.scroll = function() {\n              if ($scope.hasPages) {\n                $scope.hasPages = false;\n                $q.when(loadPage(page + 1))\n                  .then(applyPageContents)\n                  .then(function() {\n                    page += 1;\n                    $scope.hasPages = hasPages();\n                  });\n              }\n            };\n          }\n        ]\n      };\n    }\n  ]);\n})();\n","/* global angular */\n(function() {\n  'use strict';\n\n  angular.module('tenthousandthings').directive('tttThing', [\n    function() {\n      return {\n        restrict: 'E',\n        replace: true,\n        scope: {\n          thing: '='\n        },\n        templateUrl: 'thing.html',\n        controller: [\n          '$sce', '$scope',\n          function($sce, $scope) {\n\n            $scope.getContent = function() {\n              if ($scope.thing.loaded) {\n                return $sce.trustAsHtml($scope.thing.content);\n              }\n            };\n          }\n        ]\n      };\n    }\n  ]);\n})();\n","angular.module('tenthousandthings').run(['$templateCache', function($templateCache) {\n  'use strict';\n\n  $templateCache.put('list.html',\n    \"<div class=\\\"ttt-list\\\"\\n\" +\n    \"\\tinfinite-scroll=\\\"scroll()\\\"\\n\" +\n    \"\\tinfinite-scroll-disabled=\\\"!hasPages\\\"\\n\" +\n    \"\\tinfinite-scroll-immediate-check=\\\"false\\\"\\n\" +\n    \">\\n\" +\n    \"\\t<ttt-thing ng-repeat=\\\"thing in things\\\" thing=\\\"thing\\\"></ttt-thing>\\n\" +\n    \"</div>\"\n  );\n\n\n  $templateCache.put('thing.html',\n    \"<article ng-if=\\\"thing.loaded\\\" class=\\\"ttt-thing\\\">\\n\" +\n    \"\\t<h3>{{thing.title}}</h3>\\n\" +\n    \"\\t<div ng-bind-html=\\\"getContent()\\\"></div>\\n\" +\n    \"</article>\"\n  );\n\n}]);\n"]}